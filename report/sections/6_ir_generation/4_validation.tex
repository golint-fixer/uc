\subsection{Validation}
\label{sec:irgen_validation}

As the LLVM IR generated by the \texttt{uclang} compiler has been intentionally kept very close to the LLVM IR generated by Clang for a given uC program, testing the implementation of the IR generator becomes almost trivial. The test cases simply use Clang to generate LLVM IR from input C source files, each covering a specific language features, such as while loops or array index expressions. Since Clang outputs a lot of metadata, which is not strictly related to the semantics of the program, a post-processing script has been developed which removes any unnecessary metadata, function attributes, comments or other LLVM IR language constructs which are not required to run the test programs. The post-processed LLVM IR assembly output from Clang is then compared against the LLVM IR generated by the \texttt{uclang} IR generation algorithm, and the test case passes if the outputs are identical and it fails otherwise.

To the best of our knowledge, the LLVM IR generated by \texttt{uclang} should be valid for all possible uC programs. That being said, we have discovered a wide range of issues with the generation algorithm while developing it, and have added specific test cases to ensure that fixed bugs are not reintroduced at a later point of development.

To run the test cases of the IR generation library, invoke the following command.

\begin{verbatim}
$ go test github.com/mewmew/uc/irgen
\end{verbatim}

The input source files used to validate the IR generation algorithm may be located in the \texttt{testdata/extra/irgen} directory of the \texttt{uc} repository.

%\subsubsection{Correct RTL Test Cases}

%For listings, see Appendix~\ref{app:irgen/correct}: \nameref{app:irgen/correct}:
%\input{inc/uclang/quiet/rtl/listref.tex}

%\subsubsection{Extra Test Cases}

%For listings, see Appendix~\ref{app:irgen/extra}: \nameref{app:irgen/extra}:
%\input{inc/uclang/noisy/advanced/listref.tex}
%\input{inc/uclang/extra/irgen/listref.tex}
